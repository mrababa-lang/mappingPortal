# SlashData Vehicle Portal - Enhancement & Fixes Log

This document outlines the roadmap to transition the application from a "Mock/Prototype" state to a robust "Production" system backed by Java Spring Boot and MySQL.

**Status Key:**
[X] = Implemented in Prototype
[ ] = Pending Backend Integration/Refactoring

================================================================================
SECTION 1: CRITICAL FIXES (Production Migration)
================================================================================

## 1. Architecture & Routing
- **Task**: Replace state-based navigation with React Router.
- **Current**: `App.tsx` uses a simple state (`currentView`) for navigation.
- **Goal**: Enable deep linking, browser history support, and protected routes.
- **Prompt for AI**:
  > Refactor the application to use `react-router-dom` for navigation instead of the current state-based `currentView` variable.
  > 1. Install `react-router-dom`.
  > 2. In `index.tsx`, wrap `<App />` with `<BrowserRouter>`.
  > 3. In `App.tsx`, remove the `currentView` state. Use `<Routes>` and `<Route>` to define:
  >    - `/login` -> `LoginView`
  >    - `/` -> `Dashboard` (Protected)
  >    - `/makes` -> `MakesView` (Protected)
  >    - `/models` -> `ModelsView` (Protected)
  >    - `/types` -> `TypesView` (Protected)
  >    - `/adp/master` -> `ADPMasterView` (Protected)
  >    - `/adp/makes` -> `ADPMakesView` (Protected)
  >    - `/adp/mapping` -> `ADPMappingView` (Protected)
  >    - `/adp/review` -> `MappingReviewView` (Protected)
  >    - `/users` -> `UsersView` (Protected)
  >    - `/tracking` -> `TrackingView` (Protected)
  > 4. Create a `ProtectedRoute` component that checks for the user/token. If missing, redirect to `/login`.
  > 5. Update `components/Layout.tsx` to use `Link` or `NavLink` for sidebar items.

## 2. API Integration & ID Standardization
- **Task**: Centralize API service and switch to Integer IDs.
- **Current**: `storageService.ts` uses `localStorage` with String/UUID IDs.
- **Goal**: Connect to Spring Boot and handle Auto-Increment IDs for Makes/Models.
- **Prompt for AI**:
  > Create a new file `services/api.ts` to replace `services/storageService.ts`.
  > 1. Install `axios`.
  > 2. Initialize `axios` with base URL from env.
  > 3. **ID Migration**: Update `types.ts`. Change `id` fields for `Make`, `Model`, and `VehicleType` from `string` to `number` (or keep string if backend sends numbers as strings, but frontend must treat them as readonly/generated).
  > 4. Define typed API methods. Ensure `createMake`, `createModel`, etc., do NOT send an ID in the payload, as the database auto-increments it.
  >    - `createMake(data: Omit<Make, 'id'>): Promise<Make>`
  > 5. Implement Token handling via Interceptors (Attach Bearer token, handle 401).

## 3. Security & Secrets
- **Task**: Move AI calls to the Server-Side.
- **Current**: `geminiService.ts` exposes the API Key in the browser.
- **Goal**: Proxy AI requests through the backend.
- **Prompt for AI**:
  > Refactor `services/geminiService.ts`.
  > 1. Remove client-side `@google/genai` usage.
  > 2. Implement `generateDescription` and `suggestMapping` to call backend endpoints:
  >    - `POST /api/ai/generate-description`
  >    - `POST /api/ai/suggest-mapping`
  > 3. Ensure the backend handles the context assembly and prompts.

## 4. Authentication
- **Task**: Implement real JWT Authentication.
- **Current**: Mock login against hardcoded array.
- **Goal**: Authenticate against the backend.
- **Prompt for AI**:
  > Update `views/Login.tsx` to use real auth.
  > 1. Call `api.login({ email, password })`.
  > 2. Store JWT token in `localStorage`.
  > 3. Update global User context.

## 5. Data Handling (CSV & Concurrency)
- **Task**: Server-side CSV parsing.
- **Current**: Client-side parsing.
- **Goal**: Scalable import.
- **Prompt for AI**:
  > Update "Bulk Import" in `Makes.tsx`, `Models.tsx`, and `ADPMaster.tsx`.
  > 1. Send `FormData` with file to `POST /api/{resource}/upload`.
  > 2. Handle backend response regarding success/failure counts.

================================================================================
SECTION 2: RECOMMENDED ENHANCEMENTS (UX & Scalability)
================================================================================

## 1. State Management (Extend coverage)
- **Task**: Extend TanStack Query to all views.
- **Status**: [X] MakesView, [ ] Others.
- **Goal**: Consistent caching.
- **Prompt for AI**:
  > Extend `hooks/useVehicleData.ts` and create new hook files if necessary.
  > 1. Implement `useADPMaster`, `useADPMappings`, `useUsers`.
  > 2. Refactor `ModelsView`, `TypesView`, `ADPMasterView`, `ADPMappingView` to use these hooks instead of `useEffect` fetching.
  > 3. Ensure `queryClient.invalidateQueries` is called after mutations (Create/Update/Delete).

## 2. Form Handling (Extend coverage)
- **Task**: Apply Zod & React Hook Form to remaining views.
- **Status**: [X] ModelsView, [ ] MakesView, TypesView, UsersView.
- **Goal**: Robust validation.
- **Prompt for AI**:
  > Refactor `MakesView`, `TypesView`, and `UsersView` forms.
  > 1. Create Zod schemas for Make, Type, and User.
  > 2. Replace controlled inputs with `useForm` registers.
  > 3. Display validation errors inline.

## 3. DevOps & Quality
- **Task**: Error Boundaries & Tests.
- **Goal**: Production reliability.
- **Prompt for AI**:
  > Enhance app reliability.
  > 1. Create `components/ErrorBoundary.tsx`.
  > 2. Install `vitest` and `@testing-library/react`.
  > 3. Create unit tests for `Login.test.tsx` and `Dashboard.test.tsx`.
